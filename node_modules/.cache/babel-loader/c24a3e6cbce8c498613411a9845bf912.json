{"ast":null,"code":"'use strict'; // http://dev.mysql.com/doc/internals/en/com-register-slave.html\n// note that documentation is incorrect, for example command code is actually 0x15 but documented as 0x14\n\nvar _classCallCheck = require(\"/root/Test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/root/Test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar Packet = require('../packets/packet');\n\nvar CommandCodes = require('../constants/commands');\n\nvar RegisterSlave = /*#__PURE__*/function () {\n  function RegisterSlave(opts) {\n    _classCallCheck(this, RegisterSlave);\n\n    this.serverId = opts.serverId || 0;\n    this.slaveHostname = opts.slaveHostname || '';\n    this.slaveUser = opts.slaveUser || '';\n    this.slavePassword = opts.slavePassword || '';\n    this.slavePort = opts.slavePort || 0;\n    this.replicationRank = opts.replicationRank || 0;\n    this.masterId = opts.masterId || 0;\n  }\n\n  _createClass(RegisterSlave, [{\n    key: \"toPacket\",\n    value: function toPacket() {\n      var length = 15 + // TODO: should be ascii?\n      Buffer.byteLength(this.slaveHostname, 'utf8') + Buffer.byteLength(this.slaveUser, 'utf8') + Buffer.byteLength(this.slavePassword, 'utf8') + 3 + 4;\n      var buffer = Buffer.allocUnsafe(length);\n      var packet = new Packet(0, buffer, 0, length);\n      packet.offset = 4;\n      packet.writeInt8(CommandCodes.REGISTER_SLAVE);\n      packet.writeInt32(this.serverId);\n      packet.writeInt8(Buffer.byteLength(this.slaveHostname, 'utf8'));\n      packet.writeString(this.slaveHostname);\n      packet.writeInt8(Buffer.byteLength(this.slaveUser, 'utf8'));\n      packet.writeString(this.slaveUser);\n      packet.writeInt8(Buffer.byteLength(this.slavePassword, 'utf8'));\n      packet.writeString(this.slavePassword);\n      packet.writeInt16(this.slavePort);\n      packet.writeInt32(this.replicationRank);\n      packet.writeInt32(this.masterId);\n      return packet;\n    }\n  }]);\n\n  return RegisterSlave;\n}();\n\nmodule.exports = RegisterSlave;","map":{"version":3,"sources":["/root/Test/node_modules/mysql2/lib/packets/register_slave.js"],"names":["Packet","require","CommandCodes","RegisterSlave","opts","serverId","slaveHostname","slaveUser","slavePassword","slavePort","replicationRank","masterId","length","Buffer","byteLength","buffer","allocUnsafe","packet","offset","writeInt8","REGISTER_SLAVE","writeInt32","writeString","writeInt16","module","exports"],"mappings":"AAAA,a,CAEA;AACA;;;;;;AAEA,IAAMA,MAAM,GAAGC,OAAO,CAAC,mBAAD,CAAtB;;AACA,IAAMC,YAAY,GAAGD,OAAO,CAAC,uBAAD,CAA5B;;IAEME,a;AACJ,yBAAYC,IAAZ,EAAkB;AAAA;;AAChB,SAAKC,QAAL,GAAgBD,IAAI,CAACC,QAAL,IAAiB,CAAjC;AACA,SAAKC,aAAL,GAAqBF,IAAI,CAACE,aAAL,IAAsB,EAA3C;AACA,SAAKC,SAAL,GAAiBH,IAAI,CAACG,SAAL,IAAkB,EAAnC;AACA,SAAKC,aAAL,GAAqBJ,IAAI,CAACI,aAAL,IAAsB,EAA3C;AACA,SAAKC,SAAL,GAAiBL,IAAI,CAACK,SAAL,IAAkB,CAAnC;AACA,SAAKC,eAAL,GAAuBN,IAAI,CAACM,eAAL,IAAwB,CAA/C;AACA,SAAKC,QAAL,GAAgBP,IAAI,CAACO,QAAL,IAAiB,CAAjC;AACD;;;;WAED,oBAAW;AACT,UAAMC,MAAM,GACV,KAAK;AACLC,MAAAA,MAAM,CAACC,UAAP,CAAkB,KAAKR,aAAvB,EAAsC,MAAtC,CADA,GAEAO,MAAM,CAACC,UAAP,CAAkB,KAAKP,SAAvB,EAAkC,MAAlC,CAFA,GAGAM,MAAM,CAACC,UAAP,CAAkB,KAAKN,aAAvB,EAAsC,MAAtC,CAHA,GAIA,CAJA,GAKA,CANF;AAOA,UAAMO,MAAM,GAAGF,MAAM,CAACG,WAAP,CAAmBJ,MAAnB,CAAf;AACA,UAAMK,MAAM,GAAG,IAAIjB,MAAJ,CAAW,CAAX,EAAce,MAAd,EAAsB,CAAtB,EAAyBH,MAAzB,CAAf;AACAK,MAAAA,MAAM,CAACC,MAAP,GAAgB,CAAhB;AACAD,MAAAA,MAAM,CAACE,SAAP,CAAiBjB,YAAY,CAACkB,cAA9B;AACAH,MAAAA,MAAM,CAACI,UAAP,CAAkB,KAAKhB,QAAvB;AACAY,MAAAA,MAAM,CAACE,SAAP,CAAiBN,MAAM,CAACC,UAAP,CAAkB,KAAKR,aAAvB,EAAsC,MAAtC,CAAjB;AACAW,MAAAA,MAAM,CAACK,WAAP,CAAmB,KAAKhB,aAAxB;AACAW,MAAAA,MAAM,CAACE,SAAP,CAAiBN,MAAM,CAACC,UAAP,CAAkB,KAAKP,SAAvB,EAAkC,MAAlC,CAAjB;AACAU,MAAAA,MAAM,CAACK,WAAP,CAAmB,KAAKf,SAAxB;AACAU,MAAAA,MAAM,CAACE,SAAP,CAAiBN,MAAM,CAACC,UAAP,CAAkB,KAAKN,aAAvB,EAAsC,MAAtC,CAAjB;AACAS,MAAAA,MAAM,CAACK,WAAP,CAAmB,KAAKd,aAAxB;AACAS,MAAAA,MAAM,CAACM,UAAP,CAAkB,KAAKd,SAAvB;AACAQ,MAAAA,MAAM,CAACI,UAAP,CAAkB,KAAKX,eAAvB;AACAO,MAAAA,MAAM,CAACI,UAAP,CAAkB,KAAKV,QAAvB;AACA,aAAOM,MAAP;AACD;;;;;;AAGHO,MAAM,CAACC,OAAP,GAAiBtB,aAAjB","sourcesContent":["'use strict';\n\n// http://dev.mysql.com/doc/internals/en/com-register-slave.html\n// note that documentation is incorrect, for example command code is actually 0x15 but documented as 0x14\n\nconst Packet = require('../packets/packet');\nconst CommandCodes = require('../constants/commands');\n\nclass RegisterSlave {\n  constructor(opts) {\n    this.serverId = opts.serverId || 0;\n    this.slaveHostname = opts.slaveHostname || '';\n    this.slaveUser = opts.slaveUser || '';\n    this.slavePassword = opts.slavePassword || '';\n    this.slavePort = opts.slavePort || 0;\n    this.replicationRank = opts.replicationRank || 0;\n    this.masterId = opts.masterId || 0;\n  }\n\n  toPacket() {\n    const length =\n      15 + // TODO: should be ascii?\n      Buffer.byteLength(this.slaveHostname, 'utf8') +\n      Buffer.byteLength(this.slaveUser, 'utf8') +\n      Buffer.byteLength(this.slavePassword, 'utf8') +\n      3 +\n      4;\n    const buffer = Buffer.allocUnsafe(length);\n    const packet = new Packet(0, buffer, 0, length);\n    packet.offset = 4;\n    packet.writeInt8(CommandCodes.REGISTER_SLAVE);\n    packet.writeInt32(this.serverId);\n    packet.writeInt8(Buffer.byteLength(this.slaveHostname, 'utf8'));\n    packet.writeString(this.slaveHostname);\n    packet.writeInt8(Buffer.byteLength(this.slaveUser, 'utf8'));\n    packet.writeString(this.slaveUser);\n    packet.writeInt8(Buffer.byteLength(this.slavePassword, 'utf8'));\n    packet.writeString(this.slavePassword);\n    packet.writeInt16(this.slavePort);\n    packet.writeInt32(this.replicationRank);\n    packet.writeInt32(this.masterId);\n    return packet;\n  }\n}\n\nmodule.exports = RegisterSlave;\n"]},"metadata":{},"sourceType":"script"}