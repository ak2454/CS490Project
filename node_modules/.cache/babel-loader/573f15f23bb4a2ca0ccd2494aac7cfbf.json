{"ast":null,"code":"'use strict'; //const PLUGIN_NAME = 'mysql_native_password';\n\nvar auth41 = require('../auth_41.js');\n\nmodule.exports = function (pluginOptions) {\n  return function (_ref) {\n    var connection = _ref.connection,\n        command = _ref.command;\n    var password = command.password || pluginOptions.password || connection.config.password;\n    var passwordSha1 = command.passwordSha1 || pluginOptions.passwordSha1 || connection.config.passwordSha1;\n    return function (data) {\n      var authPluginData1 = data.slice(0, 8);\n      var authPluginData2 = data.slice(8, 20);\n      var authToken;\n\n      if (passwordSha1) {\n        authToken = auth41.calculateTokenFromPasswordSha(passwordSha1, authPluginData1, authPluginData2);\n      } else {\n        authToken = auth41.calculateToken(password, authPluginData1, authPluginData2);\n      }\n\n      return authToken;\n    };\n  };\n};","map":{"version":3,"sources":["/root/Test/node_modules/mysql2/lib/auth_plugins/mysql_native_password.js"],"names":["auth41","require","module","exports","pluginOptions","connection","command","password","config","passwordSha1","data","authPluginData1","slice","authPluginData2","authToken","calculateTokenFromPasswordSha","calculateToken"],"mappings":"AAAA,a,CAEA;;AACA,IAAMA,MAAM,GAAGC,OAAO,CAAC,eAAD,CAAtB;;AAEAC,MAAM,CAACC,OAAP,GAAiB,UAAAC,aAAa;AAAA,SAAI,gBAA6B;AAAA,QAA1BC,UAA0B,QAA1BA,UAA0B;AAAA,QAAdC,OAAc,QAAdA,OAAc;AAC7D,QAAMC,QAAQ,GACZD,OAAO,CAACC,QAAR,IAAoBH,aAAa,CAACG,QAAlC,IAA8CF,UAAU,CAACG,MAAX,CAAkBD,QADlE;AAEA,QAAME,YAAY,GAChBH,OAAO,CAACG,YAAR,IACAL,aAAa,CAACK,YADd,IAEAJ,UAAU,CAACG,MAAX,CAAkBC,YAHpB;AAIA,WAAO,UAAAC,IAAI,EAAI;AACb,UAAMC,eAAe,GAAGD,IAAI,CAACE,KAAL,CAAW,CAAX,EAAc,CAAd,CAAxB;AACA,UAAMC,eAAe,GAAGH,IAAI,CAACE,KAAL,CAAW,CAAX,EAAc,EAAd,CAAxB;AACA,UAAIE,SAAJ;;AACA,UAAIL,YAAJ,EAAkB;AAChBK,QAAAA,SAAS,GAAGd,MAAM,CAACe,6BAAP,CACVN,YADU,EAEVE,eAFU,EAGVE,eAHU,CAAZ;AAKD,OAND,MAMO;AACLC,QAAAA,SAAS,GAAGd,MAAM,CAACgB,cAAP,CACVT,QADU,EAEVI,eAFU,EAGVE,eAHU,CAAZ;AAKD;;AACD,aAAOC,SAAP;AACD,KAlBD;AAmBD,GA1B6B;AAAA,CAA9B","sourcesContent":["'use strict';\n\n//const PLUGIN_NAME = 'mysql_native_password';\nconst auth41 = require('../auth_41.js');\n\nmodule.exports = pluginOptions => ({ connection, command }) => {\n  const password =\n    command.password || pluginOptions.password || connection.config.password;\n  const passwordSha1 =\n    command.passwordSha1 ||\n    pluginOptions.passwordSha1 ||\n    connection.config.passwordSha1;\n  return data => {\n    const authPluginData1 = data.slice(0, 8);\n    const authPluginData2 = data.slice(8, 20);\n    let authToken;\n    if (passwordSha1) {\n      authToken = auth41.calculateTokenFromPasswordSha(\n        passwordSha1,\n        authPluginData1,\n        authPluginData2\n      );\n    } else {\n      authToken = auth41.calculateToken(\n        password,\n        authPluginData1,\n        authPluginData2\n      );\n    }\n    return authToken;\n  };\n};\n"]},"metadata":{},"sourceType":"script"}